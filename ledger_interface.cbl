       IDENTIFICATION DIVISION.
       PROGRAM-ID. LEDGER-INTERFACE.

       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
           DECIMAL-POINT IS COMMA.

       DATA DIVISION.
       FILE SECTION.

       WORKING-STORAGE SECTION.
       01 WS-OPERATION PIC X(1).
           88 ADD-TRANSACTION VALUE 'A'.
           88 READ-TRANSACTIONS VALUE 'R'.
           88 EXIT-PROGRAM VALUE 'X'.
       01 WS-SENDER PIC X(20).
       01 WS-RECIPIENT PIC X(20).
       01 WS-AMOUNT PIC 9(10)V99.
       01 WS-TIMESTAMP PIC 9(10).
       01 WS-STATUS-CODE PIC XX.
       01 WS-DATE-TIME.
           05 WS-YEAR PIC 9(4).
           05 WS-MONTH PIC 9(2).
           05 WS-DAY PIC 9(2).
           05 WS-HOUR PIC 9(2).
           05 WS-MINUTE PIC 9(2).
           05 WS-SECOND PIC 9(2).

       PROCEDURE DIVISION.
       MAIN-ROUTINE.
           PERFORM INITIALIZE-PROGRAM
           PERFORM MAIN-LOOP UNTIL EXIT-PROGRAM
           PERFORM CLOSE-PROGRAM
           STOP RUN.

       INITIALIZE-PROGRAM.
           DISPLAY "LEDGER INTERFACE"
           DISPLAY "-----------------"
           DISPLAY "A - ADD TRANSACTION"
           DISPLAY "R - READ TRANSACTIONS"
           DISPLAY "X - EXIT PROGRAM"
           DISPLAY "-----------------".

       MAIN-LOOP.
           DISPLAY "SELECT OPERATION: (A/R/X)"
           ACCEPT WS-OPERATION
           EVALUATE TRUE
               WHEN ADD-TRANSACTION
                   PERFORM ADD-TRANSACTION-ROUTINE
               WHEN READ-TRANSACTIONS
                   PERFORM READ-TRANSACTIONS-ROUTINE
               WHEN EXIT-PROGRAM
                   DISPLAY "EXITING PROGRAM..."
               WHEN OTHER
                   DISPLAY "INVALID OPERATION, TRY AGAIN."
           END-EVALUATE.

       ADD-TRANSACTION-ROUTINE.
           DISPLAY "ENTER SENDER:"
           ACCEPT WS-SENDER
           DISPLAY "ENTER RECIPIENT:"
           ACCEPT WS-RECIPIENT
           DISPLAY "ENTER AMOUNT:"
           ACCEPT WS-AMOUNT
           PERFORM GET-CURRENT-DATE-TIME
           CALL 'LEDGER' USING WS-SENDER WS-RECIPIENT WS-AMOUNT WS-TIMESTAMP
           DISPLAY "TRANSACTION ADDED SUCCESSFULLY".

       READ-TRANSACTIONS-ROUTINE.
           CALL 'LEDGER' USING 'R'
           DISPLAY "TRANSACTIONS READ SUCCESSFULLY".

       GET-CURRENT-DATE-TIME.
           ACCEPT WS-DATE-TIME FROM DATE
           ACCEPT WS-TIMESTAMP FROM TIME
           MOVE FUNCTION NUMVAL-C(WS-YEAR) TO WS-YEAR
           MOVE FUNCTION NUMVAL-C(WS-MONTH) TO WS-MONTH
           MOVE FUNCTION NUMVAL-C(WS-DAY) TO WS-DAY
           MOVE FUNCTION NUMVAL-C(WS-HOUR) TO WS-HOUR
           MOVE FUNCTION NUMVAL-C(WS-MINUTE) TO WS-MINUTE
           MOVE FUNCTION NUMVAL-C(WS-SECOND) TO WS-SECOND
           STRING WS-YEAR DELIMITED BY SIZE
                  WS-MONTH DELIMITED BY SIZE
                  WS-DAY DELIMITED BY SIZE
                  WS-HOUR DELIMITED BY SIZE
                  WS-MINUTE DELIMITED BY SIZE
                  WS-SECOND DELIMITED BY SIZE
                  INTO WS-TIMESTAMP.

       CLOSE-PROGRAM.
           DISPLAY "CLOSING LEDGER INTERFACE".

       END PROGRAM LEDGER-INTERFACE.
